<!-- Modal -->
<div class="modal fade" id="expense" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">New expense</h1>
      </div>
      <div class="modal-body text-center">
        <div class="row justify-content-center pb-5">
          <div class="col-8">
              <%= simple_form_for @expense do |f| %>
                <%= f.input :category, collection: Expense::CATEGORY , selected: 1 %>
                <%= f.input :payment_type, collection: Expense::PAYMENT_TYPE, selected: 1 %>
                <%= f.input :date, as: :hidden, html5: true , input_html: {value: Date.today} %>
                <%= f.input :place, as: :hidden, input_html: {value: "place"} %>
                <%= f.input :quantity, as: :hidden, input_html: {value: 1, inputmode: "numeric"} %>
                <%= f.input :unity, as: :hidden, input_html: {value: "un"} %>
                <%= f.input :value, as: :hidden, input_html: {value: "10"} %>
                <%= f.input :photo %>
                <div class="mb-3">or</div>
                <%= link_to "Add manually", new_expense_path %>
                <%= f.button :submit, class: 'btn btn-primary btn-sm' %>
              <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Floating buttons -->
<div class="btn-group dropup position-fixed bottom-0 end-0  mb-5 pb-4 pe-3 floating-btn">
  <button class="border border-0 dropdown-toggle hide-toggle" data-bs-toggle="dropdown" aria-expanded="false">
    <i class="fa-solid fa-circle-plus fa-2xl text-primary"></i>
  </button>
  <ul class="dropdown-menu mb-3 me-1 border border-0 bg-transparent">
    <li class="d-flex justify-content-end mt-2">
      <a class="me-2" data-bs-toggle="modal" data-bs-target="#expense" role="button">
        add expense
        <i class="fa-solid fa-receipt fa-xl pe-1" style="color: #E67E22;"></i>
      </a>
    </li>
    <li class="d-flex justify-content-end mt-2">
      <a href="<%= new_income_path %>" class="me-2">
        add income
        <i class="fa-solid fa-money-bill-wave fa-xl" style="color: #6ed7b7;"></i>
      </a>
    </li>
  </ul>
</div>
<!-- dashboard charts -->
<div class="container mt-3 mb-5 py-3 rounded-4" style="background-color: #f4f4f4">
  <div class="d-flex flex-column rounded-4 shadow-sm p-3 my-2" style="background-color: #fff" >
    <span class="fs-1 fw-bold <%= @color %> "> <%= number_to_currency(@saldo, unit: "R$ ", separator: ",", delimiter: ".") %> </span>
    <span>Total balance from all accounts</span>
  </div>
  <div class="d-flex flex-column justify-content-between mx-4">
    <div>
      <h1>Overview</h1>
      <p>View all of your Income and Spendings.</p>
    </div>
  </div>
  <div class="d-flex">
    <div class="container text-center">
      <div class="row">
        <div class="col-12 col-lg-6 card-dashboard border">
          <% incomes_data = current_user.incomes.group_by_month(:date, format: "%b %Y").sum(:value) %>
          <% expenses_data = current_user.expenses.group_by_month(:date, format: "%b %Y").sum(:value) %>
          <%= column_chart [
            { name: 'Expenses', data: expenses_data, color: '#FF0000'},
            { name: 'Incomes', data: incomes_data, color: '#00FF00' }
          ], stacked: false %>
        </div>
        <div class="col card-dashboard border">
          <%= pie_chart current_user.expenses.group(:category).sum(:value), loading: "Loading...", empty: "No data" %>
        </div>
      </div>
      <div class="row">
        <div class="col-12 col-md-6 card-dashboard border">
          <%= bar_chart current_user.expenses.group(:category).sum(:value), loading: "Loading...", empty: "No data" %>
        </div>
        <div class="col card-dashboard border">
        </div>
      </div>
      <div class="row">
        <div class="col card-dashboard border transactions-card">
          <h5>Your top 5 expenses</h5>
          <%= render 'expenses/index_expenses', expenses: @top %>
        </div>
      </div>
    </div>
  </div>
</div>
